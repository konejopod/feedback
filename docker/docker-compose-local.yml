version: '3.5'

services:

  # api service
  api_db:
    image: mongo:4.2.0
    container_name: fb_mongodb
    user: "${UID}:${GID}"
    env_file: 
      - ./local/.env
    volumes:
      - ./local/mongo/data:/data/db
    restart: unless-stopped
    networks:
      - fb_network
  api:
    build:
      context: .
      dockerfile: api.dockerfile
    container_name: fb_api
    user: "${UID}:${GID}"
    depends_on:
      - api_db
    ports:
      - "3000:3000"
    volumes:
      - ../api:/api
    restart: unless-stopped
    networks:
      - fb_network

  #view:
  #  build: 
  #    context: .
  #    dockerfile: view.dockerfile
  #  ports:
  #    - '5000:5000'
  #  volumes:
  #    - ../view:/app

  #nginx:
  #  image: nginx:latest
  #  ports:
  #    - '80:80'
  #  depends_on:
  #    - view
  #  volumes:
  #    - ../config/nginx.conf:/etc/nginx/conf.d/default.conf:ro
  
  # database:
  #   image: mongo
  #   restart: always
  #   environment:
  #     MONGODB_USER: "${MONGO_USER}"
  #     MONGODB_DATABASE: "${MONGO_DB}"
  #     MONGODB_PASS: "${MONGO_DB}"
  #   volumes:
  #     - ../mongo/data:/data/db

networks: 
  fb_network:
